<%- include('header_user') %>
<% if (messages && messages.length) { %>
  <ul>
    <% messages.forEach(function(msg) { %>
      <li><%= msg %></li>
    <% }); %>
  </ul>
<% } %>
<form method="POST" action="/change-password">
  <label>Current Password:</label>
  <input type="password" name="oldPassword" required>
  <br>
  <label>New Password:</label>
  <input type="password" name="newPassword" required>
  <br>
  <% if (locals.passwordRequirements) { %>
  <div class="password-requirements">
    <h3>Password Requirements:</h3>
    <ul>
      <li>At least <%= passwordRequirements.minLength %> characters long</li>
      <li>At least one uppercase letter (A-Z)</li>
      <li>At least one lowercase letter (a-z)</li>
      <li>At least one number (0-9)</li>
      <li>At least one special character (<%= passwordRequirements.allowedSpecialChars %>)</li>
    </ul>
  </div>
  <% } %>
  <button type="submit">Change Password</button>
</form>
<script src="/static/password-validator.js"></script>